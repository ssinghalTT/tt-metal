add_library(fabric)
add_library(TT::Fabric ALIAS fabric)

target_sources(
    fabric
    PRIVATE
        control_plane.cpp
        routing_table_generator.cpp
        mesh_graph.cpp
)

target_link_libraries(
    fabric
    PRIVATE
        umd::device
        magic_enum
        fmt::fmt-header-only
        yaml-cpp::yaml-cpp
        Metalium::Metal::Impl
)

target_precompile_headers(
    fabric
    PRIVATE
        <functional>
        <map>
        <memory>
        <unordered_map>
        <variant>
        <vector>
)

target_compile_options(fabric PRIVATE -Wno-int-to-pointer-cast)

set_target_properties(
    fabric
    PROPERTIES
        INSTALL_RPATH
            "${PROJECT_BINARY_DIR}/lib"
)
